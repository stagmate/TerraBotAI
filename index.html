<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>TerraBot - Your NASA-Powered Farm Advisor</title>
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
Â  Â  <style>
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  Â  Â  }
Â  Â  Â  Â  .chat-bubble {
Â  Â  Â  Â  Â  Â  max-width: 80%;
Â  Â  Â  Â  Â  Â  word-wrap: break-word;
Â  Â  Â  Â  }
Â  Â  Â  Â  .user-bubble {
Â  Â  Â  Â  Â  Â  background-color: #3b82f6; /* blue-500 */
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .bot-bubble {
Â  Â  Â  Â  Â  Â  background-color: #e5e7eb; /* gray-200 */
Â  Â  Â  Â  Â  Â  color: #1f2937; /* gray-800 */
Â  Â  Â  Â  }
Â  Â  Â  Â  .map-placeholder {
Â  Â  Â  Â  Â  Â  background-color: #d1fae5; /* green-100 */
Â  Â  Â  Â  Â  Â  border: 2px dashed #34d399; /* green-400 */
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  color: #065f46; /* green-800 */
Â  Â  Â  Â  }
Â  Â  Â  Â  .chart-placeholder {
Â  Â  Â  Â  Â  Â  background-color: #e0f2fe; /* sky-100 */
Â  Â  Â  Â  Â  Â  border: 2px dashed #7dd3fc; /* sky-300 */
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  color: #0c4a6e; /* sky-800 */
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body class="bg-gray-100 antialiased">

Â  Â  <div class="container mx-auto p-4 max-w-6xl">
Â  Â  Â  Â  <header class="text-center mb-6">
Â  Â  Â  Â  Â  Â  <h1 class="text-4xl font-bold text-gray-800">TerraBot ðŸŒ±</h1>
Â  Â  Â  Â  Â  Â  <p class="text-lg text-gray-600 mt-2">Your NASA-Powered Farm Advisor (with GenAI)</p>
Â  Â  Â  Â  </header>

Â  Â  Â  Â  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg shadow-lg p-4 flex flex-col h-[75vh]">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-semibold text-gray-700 mb-4 border-b pb-2">Conversational AI Assistant</h2>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="chat-history" class="flex-1 overflow-y-auto mb-4 p-2 bg-gray-50 rounded-md">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-start mb-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="bot-bubble p-3 rounded-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm">Hello! I'm TerraBot. Please define your farm area on the map, then ask me a question about it. For example: "Should I irrigate today?"</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center space-x-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="chat-input" class="flex-1 p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" placeholder="Ask about your farm..." disabled>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button id="send-btn" class="bg-blue-500 text-white font-semibold px-6 py-3 rounded-lg hover:bg-blue-600 transition duration-300 disabled:bg-gray-400" disabled>Send</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg shadow-lg p-4 h-[40vh] flex flex-col">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-2xl font-semibold text-gray-700 mb-4 border-b pb-2">Farm Location & Data Layers</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div id="map" class="map-placeholder flex-1 rounded-md">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="map-prompt">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-semibold">Click Here to Define Your Farm</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm">(This simulates dropping a pin or drawing a boundary)</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-white rounded-lg shadow-lg p-4 h-[calc(35vh-1.5rem)] flex flex-col">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <h2 class="text-2xl font-semibold text-gray-700 mb-4 border-b pb-2">Farm Health Dashboard</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div id="dashboard" class="flex-1 grid grid-cols-1 md:grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div id="soil-moisture-chart" class="chart-placeholder rounded-md">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="font-semibold">Soil Moisture (SMAP)</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div id="ndvi-chart" class="chart-placeholder rounded-md">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="font-semibold">Vegetation Health (MODIS)</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

<script>
Â  Â  const chatHistory = document.getElementById('chat-history');
Â  Â  const chatInput = document.getElementById('chat-input');
Â  Â  const sendBtn = document.getElementById('send-btn');
Â  Â  const map = document.getElementById('map');
Â  Â  const mapPrompt = document.getElementById('map-prompt');
Â  Â  const soilMoistureChart = document.getElementById('soil-moisture-chart');
Â  Â  const ndviChart = document.getElementById('ndvi-chart');

Â  Â  let farmDefined = false;
Â  Â  // --- MODIFIED: Added more data points to the farm data object ---
Â  Â  let farmData = {
Â  Â  Â  Â  soilMoisture: 0,
Â  Â  Â  Â  ndvi: 0,
Â  Â  Â  Â  rainfall: 0,
Â  Â  Â  Â  location: "Not set",
Â  Â  Â  Â  soilAnalysis: null,
Â  Â  Â  Â  predictions: null
Â  Â  };

Â  Â  // --- Event Listeners ---
Â  Â  map.addEventListener('click', () => {
Â  Â  Â  Â  if (!farmDefined) {
Â  Â  Â  Â  Â  Â  defineFarm();
Â  Â  Â  Â  }
Â  Â  });

Â  Â  sendBtn.addEventListener('click', handleUserMessage);
Â  Â  chatInput.addEventListener('keyup', (event) => {
Â  Â  Â  Â  if (event.key === 'Enter') {
Â  Â  Â  Â  Â  Â  handleUserMessage();
Â  Â  Â  Â  }
Â  Â  });
Â  Â Â 
Â  Â  // --- Core Functions ---
Â  Â  function defineFarm() {
Â  Â  Â  Â  farmDefined = true;
Â  Â  Â  Â  mapPrompt.innerHTML = `
Â  Â  Â  Â  Â  Â  <h3 class="text-lg font-semibold text-green-700">âœ… Farm Location Set!</h3>
Â  Â  Â  Â  Â  Â  <p class="text-sm">Fetching NASA data for your location...</p>
Â  Â  Â  Â  `;
Â  Â  Â  Â  map.classList.remove('map-placeholder');
Â  Â  Â  Â  map.style.backgroundImage = "url('https://placehold.co/600x400/34d399/FFFFFF?text=Farm+Area')";
Â  Â  Â  Â  map.style.backgroundSize = "cover";

Â  Â  Â  Â  chatInput.disabled = false;
Â  Â  Â  Â  sendBtn.disabled = false;
Â  Â  Â  Â Â 
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â mapPrompt.innerHTML = `<p class="text-sm bg-green-700 text-white p-2 rounded">Ready to provide insights!</p>`;
Â  Â  Â  Â  Â  Â  Â farmData.location = "Kookas, Rajasthan, India";
Â  Â  Â  Â  Â  Â  Â farmData.soilMoisture = 0.35;
Â  Â  Â  Â  Â  Â  Â farmData.ndvi = 0.82;
Â  Â  Â  Â  Â  Â  Â updateDashboard(farmData.soilMoisture, farmData.ndvi);
Â  Â  Â  Â  }, 1500);

Â  Â  Â  Â  Â addBotMessage(`Great! Your farm near ${farmData.location} is defined. I have analyzed the latest NASA data. What would you like to know?`);
Â  Â  }

Â  Â  // --- MODIFIED: Make this function async to await the AI response ---
Â  Â  async function handleUserMessage() {
Â  Â  Â  Â  const message = chatInput.value.trim();
Â  Â  Â  Â  if (message) {
Â  Â  Â  Â  Â  Â  addUserMessage(message);
Â  Â  Â  Â  Â  Â  chatInput.value = '';
Â  Â  Â  Â  Â  Â  // Await the response from the AI before proceeding
Â  Â  Â  Â  Â  Â  await processUserQueryWithGenAI(message.toLowerCase());
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // --- NEW: Function to process user query using a Generative AI ---
Â  Â  async function processUserQueryWithGenAI(query) {
Â  Â  Â  Â  // Step 1: Gather the current NASA data for context
Â  Â  Â  Â  farmData.soilMoisture = (Math.random() * 0.4 + 0.1).toFixed(2);
Â  Â  Â  Â  farmData.ndvi = (Math.random() * 0.4 + 0.5).toFixed(2);
Â  Â  Â  Â  farmData.rainfall = Math.random() > 0.7 ? (Math.random() * 10).toFixed(1) : 0;
Â  Â  Â  Â  updateDashboard(farmData.soilMoisture, farmData.ndvi);

Â  Â  Â  Â  // --- NEW: Call AI APIs for soil analysis and predictions ---
Â  Â  Â  Â  farmData.soilAnalysis = await callAISoilAnalysisAPI();
Â  Â  Â  Â  farmData.predictions = await callAIPredictionsAPI();

Â  Â  Â  Â  // Step 2: Construct the prompt for the AI
Â  Â  Â  Â  const systemPrompt = `You are TerraBot, an expert farm advisor. Your answers must be based *only* on the NASA data provided. Provide a clear, concise recommendation followed by a brief explanation citing the data.`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const userPrompt = `
Â  Â  Â  Â  Â  Â  Here is the latest data for my farm:
Â  Â  Â  Â  Â  Â  - Location: ${farmData.location}
Â  Â  Â  Â  Â  Â  - Soil Moisture (from NASA SMAP): ${farmData.soilMoisture} mÂ³/mÂ³ (A value below 0.20 is considered dry).
Â  Â  Â  Â  Â  Â  - Vegetation Health (from NASA MODIS NDVI): ${farmData.ndvi} (A value above 0.6 is healthy).
Â  Â  Â  Â  Â  Â  - Recent Rainfall (from NASA GPM): ${farmData.rainfall} mm.
Â  Â  Â  Â  Â  Â  - AI Soil Analysis: ${JSON.stringify(farmData.soilAnalysis)}
Â  Â  Â  Â  Â  Â  - AI Predictions: ${JSON.stringify(farmData.predictions)}

Â  Â  Â  Â  Â  Â  My question is: "${query}"
Â  Â  Â  Â  `;

Â  Â  Â  Â  // Step 3: Call the AI API (simulated here)
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const aiResponse = await getAIResponse(systemPrompt, userPrompt);
Â  Â  Â  Â  Â  Â  addBotMessage(aiResponse);
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  console.error("Error fetching AI response:", error);
Â  Â  Â  Â  Â  Â  addBotMessage("I'm sorry, I'm having trouble connecting to my AI core right now. Please try again later.");
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // --- MODIFIED: Simulated AI API Call with improved intelligence ---
Â  Â  async function getAIResponse(systemPrompt, userPrompt) {
Â  Â  Â  Â  console.log("--- Sending to AI ---");
Â  Â  Â  Â  console.log("System Prompt:", systemPrompt);
Â  Â  Â  Â  console.log("User Prompt:", userPrompt);
Â  Â  Â  Â  console.log("--------------------");
Â  Â  Â  Â Â 
Â  Â  Â  Â  return new Promise(resolve => {
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  let generatedText = "";
Â  Â  Â  Â  Â  Â  Â  Â  const lowerCasePrompt = userPrompt.toLowerCase();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (lowerCasePrompt.includes('where') || lowerCasePrompt.includes('location') || lowerCasePrompt.includes('address')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = `Your defined farm area is located near <strong>${farmData.location}</strong>. All the NASA data I provide is specifically tailored to this location.`;
Â  Â  Â  Â  Â  Â  Â  Â  }Â 
Â  Â  Â  Â  Â  Â  Â  Â  else if (lowerCasePrompt.includes('irrigate') || lowerCasePrompt.includes('water')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (farmData.soilMoisture < 0.20 && farmData.rainfall == 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = "<strong>Recommendation: You should irrigate.</strong><br>My analysis of the NASA SMAP data shows the soil moisture is low at " + farmData.soilMoisture + " mÂ³/mÂ³, and the GPM satellite indicates no recent rainfall to compensate.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (farmData.rainfall > 5) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = "<strong>Recommendation: Do not irrigate.</strong><br>The NASA GPM mission data shows significant recent rainfall of " + farmData.rainfall + " mm. Your soil moisture is adequate.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = "<strong>Recommendation: No immediate irrigation is needed.</strong><br>The soil moisture level is currently " + farmData.soilMoisture + " mÂ³/mÂ³, which is sufficient for now according to NASA SMAP data.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }Â 
Â  Â  Â  Â  Â  Â  Â  Â  else if (lowerCasePrompt.includes('health') || lowerCasePrompt.includes('crops')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (farmData.ndvi > 0.6) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = "<strong>Your crops appear to be in good health.</strong><br>The Vegetation Index (NDVI) from NASA's MODIS satellite is " + farmData.ndvi + ", which is in the healthy range.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â generatedText = "<strong>There might be a potential issue with crop health.</strong><br>The Vegetation Index (NDVI) from NASA's MODIS satellite is " + farmData.ndvi + ", which is lower than the optimal range. You may want to inspect the field for stress.";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  }Â 
Â  Â  Â  Â  Â  Â  Â  Â  // --- NEW: Added logic for new AI capabilities ---
Â  Â  Â  Â  Â  Â  Â  Â  else if (lowerCasePrompt.includes('soil analysis') || lowerCasePrompt.includes('soil health')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = `<strong>AI Soil Analysis:</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ul>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Composition: ${farmData.soilAnalysis.composition}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Nitrogen (N): ${farmData.soilAnalysis.nutrients.N}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Phosphorus (P): ${farmData.soilAnalysis.nutrients.P}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Potassium (K): ${farmData.soilAnalysis.nutrients.K}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </ul>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Overall Health: ${farmData.soilAnalysis.overallHealth}</p>`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  else if (lowerCasePrompt.includes('predictions') || lowerCasePrompt.includes('forecast')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = `<strong>AI Predictions for the next 14 days:</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ul>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Estimated Yield: ${farmData.predictions.yield}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Pest Risk: ${farmData.predictions.pestRisk}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <li>Optimal Harvest Window: ${farmData.predictions.harvestWindow}</li>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </ul>`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  else if (lowerCasePrompt.includes('advice') || lowerCasePrompt.includes('what should i do')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = `<strong>AI Farming Advisor Recommendation:</strong><br>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>${farmData.predictions.advisor}</p>`;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  generatedText = "I can help with that. Based on the provided NASA data, I can analyze your farm's condition. What specific information are you looking for regarding irrigation, crop health, or long-term forecasts?";
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  resolve(generatedText);
Â  Â  Â  Â  Â  Â  }, 1200);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // --- NEW: Simulated AI API call functions ---
Â  Â  async function callAISoilAnalysisAPI() {
Â  Â  Â  Â  // Simulates a call to /api/ai/soil-analysis
Â  Â  Â  Â  return new Promise(resolve => {
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  resolve({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  composition: "Loamy Sand",
Â  Â  Â  Â  Â  Â  Â  _Â  Â  Â  nutrients: { N: "Optimal", P: "Slightly Low", K: "Optimal" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  overallHealth: "Good, but consider a phosphorus supplement."
Â  Â  _Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 500);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  async function callAIPredictionsAPI() {
Â  Â  Â  Â  // Simulates a call to /api/ai/predictions and /api/ai/farming-advisor
Â  Â  Â  Â  return new Promise(resolve => {
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  resolve({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  yield: "95-105 bushels/acre",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  pestRisk: "Low",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  harvestWindow: "October 15-25",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  advisor: "Given the low phosphorus and upcoming dry spell, a light round of fertilization is recommended in the next 3-5 days."
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }, 700);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // --- UI Update Functions (No changes needed here) ---
Â  Â  function addUserMessage(message) {
Â  Â  Â  Â  const messageEl = document.createElement('div');
Â  Â  Â  Â  messageEl.className = 'flex justify-end mb-3';
Â  Â  Â  Â  messageEl.innerHTML = `
Â  Â  Â  Â  Â  Â  <div class="user-bubble p-3 rounded-lg">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm">${message}</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  chatHistory.appendChild(messageEl);
Â  Â  Â  Â  chatHistory.scrollTop = chatHistory.scrollHeight;
Â  Â  }

Â  Â  function addBotMessage(message) {
Â  Â  Â  Â  const messageEl = document.createElement('div');
Â  Â  Â  Â  messageEl.className = 'flex justify-start mb-3';
Â  Â  Â  Â  const typingIndicator = document.createElement('div');
Â  Â  Â  Â  typingIndicator.className = 'bot-bubble p-3 rounded-lg animate-pulse';
Â  Â  Â  Â  typingIndicator.innerHTML = `<p class="text-sm">TerraBot is thinking...</p>`;
Â  Â  Â  Â  chatHistory.appendChild(typingIndicator);
Â  Â  Â  Â  chatHistory.scrollTop = chatHistory.scrollHeight;
Â  Â  Â  Â Â 
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  messageEl.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bot-bubble p-3 rounded-lg">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ${message}
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  chatHistory.replaceChild(messageEl, typingIndicator);
Â  Â  Â  Â  Â  Â  chatHistory.scrollTop = chatHistory.scrollHeight;
Â  Â  Â  Â  }, 800);Â 
Â  Â  }

Â  Â  function updateDashboard(soilMoisture, ndvi) {
Â  Â  Â  Â  if (soilMoisture !== null) {
Â  Â  Â  Â  Â  Â  soilMoistureChart.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold text-lg">${soilMoisture}</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600">Soil Moisture (mÂ³/mÂ³)</p>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  }
Â  Â  Â  Â  if (ndvi !== null) {
Â  Â  Â  Â  Â  Â  ndviChart.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â <p class="font-semibold text-lg">${ndvi}</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-600">Vegetation Index (NDVI)</p>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  }
Â  Â  }

</script>
</body>
</html>
